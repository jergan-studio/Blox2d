<!DOCTYPE html>
<html>
<head>
  <title>Blox2D â€” Game Client</title>
  <style>
    body{margin:0;background:#000;color:white;font-family:Arial;display:flex;flex-direction:column;}
    header{padding:15px;background:#121217;text-align:center;font-weight:bold;}
    canvas{background:#111;display:block;margin:0 auto;}
    #gameInfo{padding:10px;color:#4da6ff;text-align:center;}
  </style>
</head>
<body>

<header>ðŸŽ® Blox2D Client</header>
<div id="gameInfo"></div>
<canvas id="canvas" width="800" height="500"></canvas>

<script>
const params = new URLSearchParams(location.search);
const id = params.get("id");

const games = JSON.parse(localStorage.getItem("blox_games") || "[]");
const game = games.find(g => g.id === id);

const info = document.getElementById("gameInfo");
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");

if(!game){
  info.innerText = "Game not found.";
} else {
  info.innerText = `${game.name} by ${game.author}`;
  const scriptLines = game.script.split("\n");

  // Basic player object
  const player = {x:100, y:400, w:30, h:30, speed:5};

  // Parse script for speed
  scriptLines.forEach(line => {
    line = line.trim();
    if(line.startsWith("player.speed")){
      const val = parseInt(line.split("=")[1]);
      if(!isNaN(val)) player.speed = val;
    }
  });

  // Basic controls
  const keys = {};
  window.addEventListener("keydown", e => keys[e.key] = true);
  window.addEventListener("keyup", e => keys[e.key] = false);

  function update() {
    if(keys["ArrowLeft"]) player.x -= player.speed;
    if(keys["ArrowRight"]) player.x += player.speed;
    if(keys["ArrowUp"]) player.y -= player.speed;
    if(keys["ArrowDown"]) player.y += player.speed;
    draw();
    requestAnimationFrame(update);
  }

  function draw() {
    ctx.fillStyle="#111";
    ctx.fillRect(0,0,canvas.width,canvas.height);

    // Draw player
    ctx.fillStyle="#4da6ff";
    ctx.fillRect(player.x, player.y, player.w, player.h);

    // You can draw more objects from script later
  }

  update();
}
</script>

</body>
</html>
